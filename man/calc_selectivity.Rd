% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/selectivity.R
\name{calc_selectivity}
\alias{calc_selectivity}
\title{Calculate Size Selectivity for Fishing Gear}
\usage{
calc_selectivity(w, type = "knife_edge", params = list(), log_scale = TRUE)
}
\arguments{
\item{w}{Numeric vector of body masses. By default interpreted as log10(mass in grams)
to match ZooMSS conventions, but can be linear scale if \code{log_scale = FALSE}.}

\item{type}{Character string specifying selectivity type. Options:
\itemize{
\item \code{"knife_edge"}: Step function at threshold size (default)
\item \code{"logistic"}: Smooth logistic curve
\item \code{"custom"}: User-defined function (must be provided in params$fun)
}}

\item{params}{Named list of selectivity parameters. Required parameters depend on type:
\itemize{
\item For \code{"knife_edge"}: \code{w_min} (minimum vulnerable size)
\item For \code{"logistic"}: \code{L50} (size at 50\\% selectivity), \code{L95} (size at 95\\% selectivity)
\item For \code{"custom"}: \code{fun} (function taking w as argument and returning selectivity)
}}

\item{log_scale}{Logical indicating whether \code{w} and size parameters in \code{params}
are in log10 scale. Default \code{TRUE} to match ZooMSS size class convention
(\code{w_log10}). Set to \code{FALSE} if working with linear body masses.}
}
\value{
Numeric vector of selectivity values between 0 and 1, same length as \code{w}.
}
\description{
Calculates size-dependent fishing selectivity, representing the probability
that an organism of a given size is vulnerable to fishing gear. This function
supports multiple selectivity curve types commonly used in fisheries science.
}
\details{
\strong{Knife-edge selectivity:}
All organisms above \code{w_min} are fully vulnerable (selectivity = 1),
all below are invulnerable (selectivity = 0). This represents trawl nets or
other gear with a sharp size cutoff.

\strong{Logistic selectivity:}
Smooth transition from 0 to 1 selectivity, parameterized by \code{L50} (size at
50\\% selectivity) and \code{L95} (size at 95\\% selectivity). The curve follows:
\deqn{S(w) = \frac{1}{1 + \exp(-\log(19) \cdot (w - L_{50}) / (L_{95} - L_{50}))}}

This represents gillnets or hooks where vulnerability increases gradually with size.

\strong{Custom selectivity:}
Allows user-defined selectivity functions for specialized gear types.
The custom function should accept a numeric vector and return selectivity values.
}
\note{
When using \code{log_scale = TRUE} (default), all size parameters (\code{w_min}, \code{L50}, \code{L95})
must be in log10 grams to match the ZooMSS size class grid (\code{w_log10}).
}
\examples{
# Knife-edge selectivity (log10 scale, matching ZooMSS convention)
w_log10 <- seq(-2, 3, by = 0.1)  # Size classes from 0.01g to 1000g
s_knife <- calc_selectivity(w_log10, type = "knife_edge",
                             params = list(w_min = 1))  # Vulnerable above 10g
plot(w_log10, s_knife, type = "l", xlab = "log10(mass in g)", ylab = "Selectivity")

# Logistic selectivity
s_logistic <- calc_selectivity(w_log10, type = "logistic",
                                params = list(L50 = 1.5, L95 = 2.0))
plot(w_log10, s_logistic, type = "l", xlab = "log10(mass in g)", ylab = "Selectivity")

# Custom selectivity (dome-shaped for size-selective gear)
dome_selectivity <- function(w) {
  exp(-((w - 1.5)^2) / 0.5)  # Peak selectivity at log10(mass) = 1.5
}
s_custom <- calc_selectivity(w_log10, type = "custom",
                              params = list(fun = dome_selectivity))
plot(w_log10, s_custom, type = "l", xlab = "log10(mass in g)", ylab = "Selectivity")

}
