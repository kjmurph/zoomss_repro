% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fishing.R
\name{calc_catch}
\alias{calc_catch}
\title{Calculate Catch from Fishing Mortality and Abundance}
\usage{
calc_catch(F_w, N_w, w, dw = 0.1, dt = 1, by_size = FALSE)
}
\arguments{
\item{F_w}{Matrix of dimension (ngrps × ngrid), fishing mortality rates (yr⁻¹)
for each functional group and size class. Typically from \code{\link{calc_fishing_mortality}}.}

\item{N_w}{Matrix of dimension (ngrps × ngrid), abundance density (numbers per m²)
for each functional group and size class. This is the population density
at the current time step.}

\item{w}{Numeric vector of length ngrid, body mass of each size class (grams).
Should match the size classes used in ZooMSS (\code{param$w}).}

\item{dw}{Numeric scalar, width of size classes in log10 space. Default is 0.1
to match ZooMSS convention (\code{param$dx}).}

\item{dt}{Numeric scalar, time step in years. Default is 1.0 for annual catch.
Use smaller values (e.g., 1/12 for monthly time steps) if needed.}

\item{by_size}{Logical, if TRUE returns catch by size class (matrix), if FALSE
returns total catch per group (vector). Default FALSE.}
}
\value{
If \code{by_size = FALSE} (default): Numeric vector of length ngrps containing
total catch per functional group (g m⁻² yr⁻¹).

If \code{by_size = TRUE}: Matrix of dimension (ngrps × ngrid) containing
size-resolved catch for each group (g m⁻² yr⁻¹).
}
\description{
Calculates catch biomass (yield) from fishing mortality, abundance, and body size
using the Baranov catch equation. This is the biomass removed from the population
by fishing.
}
\details{
\strong{Catch equation:}
\deqn{C(w,g) = F(w,g) \times N(w,g) \times w \times \Delta w \times \Delta t}

where:
\itemize{
\item \eqn{F(w,g)} = fishing mortality rate (yr⁻¹)
\item \eqn{N(w,g)} = abundance density (numbers m⁻²)
\item \eqn{w} = individual body mass (g)
\item \eqn{\Delta w} = size class width (accounting for log10 spacing)
\item \eqn{\Delta t} = time step duration (yr)
}

\strong{Size class integration:}
Since ZooMSS uses log10-spaced size classes, the width in linear space is:
\deqn{\Delta w_{linear} = w \times \log(10) \times dw}

\strong{Total catch per group:}
\deqn{C_{total}(g) = \sum_{w} C(w,g)}

This represents the instantaneous catch rate. For finite time periods with
changing populations, the Baranov catch equation would require integration,
but this approximation is valid for small time steps or low F values.
}
\note{
\itemize{
\item Catch units are biomass per area per time (g m⁻² yr⁻¹)
\item To convert to total regional catch, multiply by region area
\item This gives instantaneous catch; for seasonal or pulse fishing,
adjust \code{dt} accordingly
\item Returns zero when F = 0 (unfished) or N = 0 (extinct)
}
}
\examples{
# Set up example population
ngrps <- 3
ngrid <- 50
w <- 10^seq(-2, 3, length.out = ngrid)  # Body masses from 0.01g to 1000g
w_log10 <- log10(w)

# Create abundance distribution (decreasing with size)
N <- matrix(0, nrow = ngrps, ncol = ngrid)
for (g in 1:ngrps) {
  N[g, ] <- 1e6 * w^(-2)  # Power-law size spectrum
}

# Set up fishing
q <- c(0.01, 0.02, 0.015)
selectivity <- matrix(0, nrow = ngrps, ncol = ngrid)
for (g in 1:ngrps) {
  selectivity[g, ] <- calc_selectivity(w_log10, "knife_edge",
                                       list(w_min = g * 0.5))
}

# Calculate fishing mortality and catch
effort <- 100
F_w <- calc_fishing_mortality(effort, q, selectivity)
catch_total <- calc_catch(F_w, N, w, dw = 0.1)

print(catch_total)  # Total catch per group

# Get size-resolved catch
catch_by_size <- calc_catch(F_w, N, w, dw = 0.1, by_size = TRUE)
matplot(w_log10, t(catch_by_size), type = "l", lty = 1, log = "y",
        xlab = "log10(mass in g)", ylab = "Catch (g/m²/yr)",
        main = "Size-resolved catch by group")

}
\seealso{
\code{\link{calc_fishing_mortality}} for calculating F(w,g)
}
