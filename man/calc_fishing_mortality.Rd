% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fishing.R
\name{calc_fishing_mortality}
\alias{calc_fishing_mortality}
\title{Calculate Fishing Mortality from Effort and Selectivity}
\usage{
calc_fishing_mortality(effort, q, selectivity)
}
\arguments{
\item{effort}{Numeric scalar, fishing effort at current time step. Can represent
various effort metrics (vessel-days, trawl-hours, hook-hours, etc.) depending
on the application. Units should be consistent with catchability coefficient.}

\item{q}{Numeric vector of length ngrps, catchability coefficient for each
functional group (units: 1/yr per unit effort). Represents the efficiency
with which effort translates to fishing mortality.}

\item{selectivity}{Matrix of dimension (ngrps x ngrid), size-specific selectivity
for each functional group. Values should be between 0 and 1, where 0 = invulnerable
and 1 = fully vulnerable. Typically generated using calc_selectivity.}
}
\value{
Matrix of dimension (ngrps × ngrid) containing fishing mortality rates
(yr⁻¹) for each functional group and size class.
}
\description{
Calculates size- and group-specific fishing mortality rates from fishing effort,
catchability coefficients, and selectivity curves. This function implements the
standard fisheries equation: F(w,g) = E(t) × q(g) × S(w,g)
}
\details{
\strong{Fishing mortality equation:}
\deqn{F(w,g,t) = E(t) \times q(g) \times S(w,g)}

where:
\itemize{
\item \eqn{E(t)} = fishing effort at time t
\item \eqn{q(g)} = catchability of functional group g
\item \eqn{S(w,g)} = selectivity at body mass w for group g
}

This formulation allows fishing mortality to vary:
\itemize{
\item \strong{Over time:} through changes in effort E(t)
\item \strong{Among groups:} through different catchability coefficients q(g)
\item \strong{With body size:} through selectivity curves S(w,g)
}

\strong{Relationship to total mortality:}
Fishing mortality is combined with natural mortality components:
\deqn{Z(w,g,t) = M_{senescence}(w,g) + M_{predation}(w,g,t) + F(w,g,t)}
}
\note{
\itemize{
\item When effort = 0, fishing mortality is zero (unfished scenario)
\item Catchability q should be calibrated to match observed catches
\item Selectivity should be pre-calculated using \code{\link{calc_selectivity}}
for each functional group
}
}
\examples{
# Set up parameters for 3 functional groups, 50 size classes
ngrps <- 3
ngrid <- 50
w_log10 <- seq(-2, 3, length.out = ngrid)

# Define catchability (different vulnerability by group)
q <- c(0.01, 0.02, 0.015)  # Small, Medium, Large fish

# Create selectivity matrix (knife-edge at different sizes)
selectivity <- matrix(0, nrow = ngrps, ncol = ngrid)
selectivity[1, ] <- calc_selectivity(w_log10, "knife_edge", list(w_min = 0.5))
selectivity[2, ] <- calc_selectivity(w_log10, "knife_edge", list(w_min = 1.0))
selectivity[3, ] <- calc_selectivity(w_log10, "knife_edge", list(w_min = 1.5))

# Calculate fishing mortality for current effort level
effort_current <- 100  # e.g., 100 vessel-days
F_mortality <- calc_fishing_mortality(effort_current, q, selectivity)

# Examine resulting F for each group
matplot(w_log10, t(F_mortality), type = "l", lty = 1,
        xlab = "log10(mass in g)", ylab = "Fishing mortality (1/yr)",
        main = "Size-specific fishing mortality by group")
legend("topleft", legend = c("Small", "Medium", "Large"), col = 1:3, lty = 1)

}
\seealso{
\code{\link{calc_selectivity}} for generating selectivity matrices,
\code{\link{calc_catch}} for calculating resulting catch
}
